(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3447:(t,s,e)=>{"use strict";e.r(s),e.d(s,{default:()=>g});var i=e(5155),a=e(2115);async function r(t){await new Promise(s=>setTimeout(s,t))}var n=e(226);class o extends a.Component{async typeAsync(t){var s,e,i,a,n,o,c;for(let s of t){this.state.animating.push(s),this.setState(t=>({animating:[...t.animating]})),this.makeStatic();let t=[".","!","?"].includes(s),l=[",",";",":"].includes(s),p=this.props.typeSpeed;if(t&&(p=25*this.props.typeSpeed),l&&(p=10*this.props.typeSpeed),this.props.pitch>0){let t=s.toLowerCase();if(/[a-z0-9]/.test(t)){let r=1+(t.charCodeAt(0)%10+1)/10/5;/[aeiou]/.test(s)?null===(i=this.oscillator)||void 0===i||i.frequency.setValueAtTime(1.2*this.props.pitch*r,(null===(e=this.audioCtx)||void 0===e?void 0:e.currentTime)||0):null===(n=this.oscillator)||void 0===n||n.frequency.setValueAtTime(this.props.pitch*r,(null===(a=this.audioCtx)||void 0===a?void 0:a.currentTime)||0)}else" "!=s&&(null===(c=this.oscillator)||void 0===c||c.frequency.setValueAtTime(0,(null===(o=this.audioCtx)||void 0===o?void 0:o.currentTime)||0))}await r(p)}this.props.pitch>0&&(this.oscillator.stop(),this.audioCtx.close()),null===(s=this.props.onFinished)||void 0===s||s.call(this)}async makeStatic(){await r(this.props.characterAnimationDuration);let t=this.state.animating.shift();this.setState(s=>({animating:[...s.animating],text:s.text+t}))}render(){let t=this.props.characterAnimationDuration/1e3;return(0,i.jsxs)("span",{style:{color:this.props.color,fontSize:this.props.size,whiteSpace:"pre-wrap"},children:[(0,i.jsx)(n.P.span,{children:this.state.text},"static-text"),this.state.animating.map((s,e)=>(0,i.jsx)(n.P.div,{style:{display:"inline-block"},initial:{opacity:0},animate:{opacity:1},transition:{duration:t,ease:"easeOut"},children:s},this.state.text.length+e))]},"typewriter-span")}constructor(t){if(super(t),this.oscillator=null,this.audioCtx=null,this.isRunning=!1,this.state={animating:[],text:""},this.props.pitch>0){this.audioCtx=new window.AudioContext;let t=this.audioCtx.createGain();t.gain.value=this.props.gain/3,t.connect(this.audioCtx.destination),this.oscillator=this.audioCtx.createOscillator(),this.oscillator.type="triangle",this.oscillator.connect(t),this.oscillator.frequency.setValueAtTime(0,this.audioCtx.currentTime),this.oscillator.start()}this.isRunning||(this.isRunning=!0,this.typeAsync(this.props.text))}}let c={color:l,speed:p,size:h,pause:d,sound:y,voice:u,backgroundcolor:f,screenshake:m,nowait:function(t,s){t.startParsingAsync(s[0])}};async function l(t,s){let e=s[0],i=s[1];t.getProps().typeWriterProps.color=e,await t.startParsingAsync(i)}async function p(t,s){let e=parseInt(s[0]),i=s[1];t.getProps().typeWriterProps.typeSpeed=e,await t.startParsingAsync(i)}async function h(t,s){let e=s[0],i=s[1];t.getProps().typeWriterProps.size=e,await t.startParsingAsync(i)}async function u(t,s){let e=parseInt(s[0]),i=parseInt(s[1]),a=s[2];t.getProps().typeWriterProps.pitch=e,t.getProps().typeWriterProps.gain=i/100,await t.startParsingAsync(a)}async function d(t,s){let e=parseInt(s[0]);await r(e)}async function y(t,s){let e=s[0],i=parseInt(s[1]),a=new Audio(e);if(a.volume=i/100,a.play(),3==s.length){let e=new Promise(t=>a.onended=()=>t());await t.startParsingAsync(s[2]),await e}}async function f(t,s){let e=parseInt(s[1]),i=s[0];document.body.style.transition="background-color ".concat(e,"ms"),document.body.style.backgroundColor=i,await r(e)}async function m(t,s){let e=parseInt(s[0]),i=parseInt(s[1]),a=parseInt(s[2]),n=document.body,o=n.style.transform;for(let t=0;t<i;t++){let t=Math.random()*e-e/2,s=Math.random()*e-e/2;n.style.transform="translate(".concat(t,"px, ").concat(s,"px)"),await r(a)}n.style.transform=o}class w extends a.Component{render(){return(0,i.jsx)("div",{className:"m-8",children:this.state.writers})}getProps(){return this.propsStack[this.propsStack.length-1]}async addTypewriterAsync(t,s){if(!t)return;let e=!0,a=(0,i.jsx)(o,{...s,text:t,onFinished:async()=>e=!1},this.state.writers.length);for(this.state.writers.push(a),this.setState(t=>({writers:[...t.writers]}));e;)await r(10)}async addDefaultTypewriterAsync(t){return this.addTypewriterAsync(t,this.getProps().typeWriterProps)}async startParsingAsync(t){t=this.replaceMacros(this.extractMacros(t));let s="",e=0;for(let i of t)if("["==i&&(0==e&&s&&(await this.addDefaultTypewriterAsync(s),s=""),e++),s+=i,"]"==i){if(--e<0)throw Error("Mismatched brackets < 0");0==e&&(await this.handleCommandAsync(s),s="")}if(0!=e)throw Error("Mismatched brackets > 0");await this.addDefaultTypewriterAsync(s)}extractMacros(t){let s=/\$(\w+)\s*=\s*(.+)$/gm;for(let e of t.matchAll(s))this.macros.set(e[1],e[2]);return t=t.replaceAll(s,"[DELETE]").replaceAll(/\[DELETE\](?:\r\n|\r|\n)/g,"")}replaceMacros(t){for(let[s,e]of this.macros)t=t.replaceAll("${".concat(s,"}"),e);return t}async handleCommandAsync(t){let s=t.slice(1,-1),e=[],i="",a=0;for(let t of s)"["==t?a++:"]"==t&&a--,";"==t&&0==a?(e.push(i),i=""):i+=t;if((i||s.endsWith(";"))&&e.push(i),e[0]in c){this.startNesting();try{let t=c[e[0]](this,e.slice(1));t instanceof Promise&&await t}finally{this.endNesting()}}else throw Error("Unknown command: ".concat(e[0]))}startNesting(){let t=JSON.parse(JSON.stringify(this.getProps()));this.propsStack.push(t)}endNesting(){if(this.propsStack.pop(),0==this.propsStack.length)throw Error("Ended nesting more often than starting it.")}constructor(t){super(t),this.propsStack=[],this.macros=new Map,this.state={writers:[]},this.propsStack.push(t)}}function g(){let t=(0,a.useRef)(null);async function s(){var s,e;let i=await fetch("/parserShowcase.txt").then(t=>t.text());await (null===(s=t.current)||void 0===s?void 0:s.startParsingAsync("Parser Showcase\n\n[pause;1000]")),await (null===(e=t.current)||void 0===e?void 0:e.startParsingAsync(i))}return(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{onClick:s,children:"Start"}),(0,i.jsx)(w,{ref:t,typeWriterProps:{pitch:0,gain:1,characterAnimationDuration:300,typeSpeed:50,color:"white",size:"24px",text:""}})]})}},8323:(t,s,e)=>{Promise.resolve().then(e.bind(e,3447))}},t=>{var s=s=>t(t.s=s);t.O(0,[226,441,684,358],()=>s(8323)),_N_E=t.O()}]);