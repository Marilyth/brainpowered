(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{285:(e,t,s)=>{"use strict";s.d(t,{$:()=>l});var n=s(5155);s(2115);var a=s(4253),i=s(2085),r=s(9434);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l(e){let{className:t,variant:s,size:i,asChild:l=!1,...c}=e,d=l?a.DX:"button";return(0,n.jsx)(d,{"data-slot":"button",className:(0,r.cn)(o({variant:s,size:i,className:t})),...c})}},2346:(e,t,s)=>{"use strict";s.d(t,{w:()=>r});var n=s(5155);s(2115);var a=s(4050),i=s(9434);function r(e){let{className:t,orientation:s="horizontal",decorative:r=!0,...o}=e;return(0,n.jsx)(a.b,{"data-slot":"separator-root",decorative:r,orientation:s,className:(0,i.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...o})}},2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var n=s(5155);s(2115);var a=s(9434);function i(e){let{className:t,type:s,...i}=e;return(0,n.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...i})}},7634:(e,t,s)=>{"use strict";let n;s.r(t),s.d(t,{default:()=>ty});var a=s(5155),i=s(2115),r=s(351),o=s(226),l=s(3438);let c=(0,l.PA)(e=>{let{viewModel:t}=e;async function s(){}return(0,a.jsx)("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"},children:t.renderedTextBlocks.map((e,t)=>(0,a.jsx)("span",{style:{display:"inline",...e[0].characterStyle},children:e[1].map((n,i)=>(0,a.jsx)(o.P.span,{onAnimationEnd:s,initial:{opacity:0,...e[0].characterInitial},animate:{opacity:1,...e[0].characterAnimate},transition:{duration:e[0].opacityAnimationDuration,ease:"easeOut",...e[0].characterTransition},style:{display:"inline"},children:n},"".concat(t,"-").concat(i,"-").concat(n)))},t))},"typewriter-span")});var d=s(9249);let h={};function u(e){h[e.name]=e}class p{equals(e){return this.x===e.x&&this.y===e.y&&this.z===e.z}getDistance(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2)+Math.pow(this.z-e.z,2))}normalize(){let e=this.magnitude();return 0===e?new p(0,0,0):new p(this.x/e,this.y/e,this.z/e)}crossProduct(e){return new p(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}dotProduct(e){return this.x*e.x+this.y*e.y+this.z*e.z}magnitude(){return this.dotProduct(this)}constructor(e,t,s){this.x=e,this.y=t,this.z=s}}p=(0,d.Cg)([u],p);class m extends p{setFacingDirection(e){this.facingDirection=e.normalize();let t=new p(0,1,0).crossProduct(this.facingDirection).normalize();t=t.normalize();let s=this.facingDirection.crossProduct(t).normalize();this.basisCoordinateSystem[0]=this.facingDirection,this.basisCoordinateSystem[1]=t,this.basisCoordinateSystem[2]=s}getDirection(e){let t=e.x-this.x,s=e.y-this.y,n=e.z-this.z,a=this.basisCoordinateSystem[1].x*t+this.basisCoordinateSystem[1].y*s+this.basisCoordinateSystem[1].z*n,i=this.basisCoordinateSystem[2].x*t+this.basisCoordinateSystem[2].y*s+this.basisCoordinateSystem[2].z*n,r=this.basisCoordinateSystem[0].x*t+this.basisCoordinateSystem[0].y*s+this.basisCoordinateSystem[0].z*n;return new p(a,i,r).normalize()}getDirectionExpression(e){let t=[],s=e.x,n=e.z;return s>0?t.push("to the right"):s<0&&t.push("to the left"),n>0?t.push("front"):n<0&&t.push("behind"),e.y>0?t.push("above"):e.y<0&&t.push("below"),t.join(", ")}constructor(e,t,s){super(e,t,s),this.x=e,this.y=t,this.z=s,this.basisCoordinateSystem=[new p(0,0,1),new p(1,0,0),new p(0,1,0)],this.setFacingDirection(new p(0,0,1))}}m=(0,d.Cg)([u],m);class g{matches(e){let t=this.parent.name.toLowerCase();if(!e.some(e=>e.toLowerCase()===t))return!1;for(let t of this.actionNames)if(e.some(e=>e.toLowerCase()===t))return!0;return!1}async triggerAsync(){await this.parent.writeAsync(this.response)}constructor(e,t,s){for(let t of(this.actionNames=[],e))this.actionNames.push(t.toLowerCase());this.response=t,this.parent=s}}g=(0,d.Cg)([u],g);class x{getArea(){return this.width*this.depth}getVolume(){return this.width*this.depth*this.height}constructor(e,t,s){this.width=e,this.depth=t,this.height=s}}async function f(e){await new Promise(t=>setTimeout(t,e))}x=(0,d.Cg)([u],x);var v=s(9087);class y extends v.EventEmitter{async emitAsync(e){for(var t=arguments.length,s=Array(t>1?t-1:0),n=1;n<t;n++)s[n-1]=arguments[n];for(let t of this.listeners(e)){let e=t(...s);e instanceof Promise&&await e}}}let b=new y;var w=s(9543);class j{async InvokeAsync(e){let t=this.onTrigger(e);t instanceof Promise&&await t}toString(){let e=[this.name];for(let t of this.parameters)e.push(t.toString());return"[".concat(e.join(";"),"]")}clone(){let e=new j(this.onTrigger);for(let t of(e.name=this.name,e.description=this.description,this.parameters))e.parameters.push(t.clone());return e}constructor(e){this.name="",this.description="",this.parameters=[],this.onTrigger=()=>{},this.onTrigger=e,(0,w.l_)(this)}}class N{toString(){return this.value}clone(){let e=new N(this.name,this.description);return e.value=this.value,e}constructor(e,t){this.name="",this.description="",this.value="",this.name=e,this.description=t,(0,w.l_)(this)}}let C=[],_=new j(A);async function A(e){let t=e[0],s=e[1];n.getProps().characterInitial.color="#FFFFFF",n.getProps().characterAnimate.color=t,n.getProps().characterTransition.color={duration:.3,ease:"easeIn"},await n.startParsingAsync(s)}C.push(_),_.name="color",_.description="Changes the color of the text.",_.parameters.push(new N("color","The color to change to.")),_.parameters.push(new N("text","The text to write."));let k=new j(S);async function S(e){let t=e[0];n.getProps().characterInitial.textShadow="0em 0em 0em",n.getProps().characterAnimate.textShadow="0em 0em 0.5em",await n.startParsingAsync(t)}C.push(k),k.name="glow",k.description="Adds a glowing effect to the text.",k.parameters.push(new N("text","The text to write."));let z=new j(T);async function T(e){let t=parseInt(e[0]),s=e[1];n.getProps().typeSpeed=t,await n.startParsingAsync(s)}C.push(z),z.name="speed",z.description="Changes the speed of the text.",z.parameters.push(new N("speed","The speed to change to.")),z.parameters.push(new N("text","The text to write."));let P=new j(F);async function F(e){let t=e[0],s=e[1];n.getProps().characterStyle.fontSize=t,await n.startParsingAsync(s)}C.push(P),P.name="size",P.description="Changes the size of the text.",P.parameters.push(new N("size","The size to change to.")),P.parameters.push(new N("text","The text to write."));let E=new j(I);async function I(e){let t=parseInt(e[0]),s=parseInt(e[1]),a=e[2],i=[];for(let e=0;e<5;e++)i.push(s/(100*(e+1)));n.getProps().pitch=t,n.getProps().volumes=i,await n.startParsingAsync(a)}C.push(E),E.name="voice",E.description="Plays a voice with the given pitch and gain.",E.parameters.push(new N("pitch","The pitch of the voice.")),E.parameters.push(new N("gain","The gain of the voice.")),E.parameters.push(new N("text","The text to write."));let D=new j(L);async function L(e){let t=parseInt(e[0]);await f(t)}C.push(D),D.name="pause",D.description="Pauses for a given amount of time.",D.parameters.push(new N("time","The time to pause for."));let M=new j(O);async function O(e){let t=e[0],s=parseInt(e[1]),a=new Audio(t);if(a.volume=s/100,a.play(),3==e.length){let t=new Promise(e=>a.onended=()=>e());await n.startParsingAsync(e[2]),await t}}C.push(M),M.name="sound",M.description="Plays a sound from the given URL.",M.parameters.push(new N("url","The URL of the sound to play.")),M.parameters.push(new N("volume","The volume to play the sound at in percentage 0 - 100.")),M.parameters.push(new N("text","The text to type during the sound."));let $=new j(R);async function R(e){let t=parseInt(e[1]),s=e[0];document.body.style.transition="background-color ".concat(t,"ms"),document.body.style.backgroundColor=s,await f(t)}C.push($),$.name="backgroundcolor",$.description="Changes the background color of the page.",$.parameters.push(new N("color","The color to change to.")),$.parameters.push(new N("speed","The speed of the transition."));let q=new j(B);async function B(e){let t=parseInt(e[0]),s=parseInt(e[1]),n=parseInt(e[2]),a=document.body,i=a.style.transform;for(let e=0;e<s;e++){let e=Math.random()*t-t/2,s=Math.random()*t-t/2;a.style.transform="translate(".concat(e,"px, ").concat(s,"px)"),await f(n)}a.style.transform=i}C.push(q),q.name="screenshake",q.description="Shakes the screen.",q.parameters.push(new N("extend","The distance to shake the screen.")),q.parameters.push(new N("shakeCount","The number of shakes.")),q.parameters.push(new N("shakeTime","The time to shake for."));let V=new j(function(e){n.startParsingAsync(e[0])});C.push(V),V.name="async",V.description="Executes a command without waiting for it to finish.",V.parameters.push(new N("text","The text to write."));let W=new j(G);async function G(e){let t=e[0],s=e.slice(1);await b.emitAsync(t,s)}C.push(W),W.name="event",W.description="Emits an event with the given arguments.",W.parameters.push(new N("eventName","The name of the event to emit.")),W.parameters.push(new N("args","The arguments to the event."));let U=new j(Y);async function Y(e){let t=e.join(";"),s=Function("context",'"use strict"; return (async function() { '.concat(t," }).call(context);"));await s.call(null,{currentTypeWriter:n,events:b})}async function X(e,t){let s=e.toLowerCase(),n=C.find(e=>e.name.toLowerCase()===s);n?await n.InvokeAsync(t):console.warn('Command "'.concat(e,'" not found.'))}C.push(U),U.name="script",U.description="Executes a script with the given arguments.",U.parameters.push(new N("args","The arguments to the script."));let Z=null;class J{changeFrequency(e){for(let t=0;t<this.overtones.length;t++)this.overtones[t][0].frequency.value=e*(t+1)}changeVolume(e){for(let t=0;t<this.overtones.length;t++)this.overtones[t][1].gain.value=e*this.toneVolumes[t]}start(){if(this.isStopped){null==Z&&(Z=new window.AudioContext);for(let e=0;e<this.toneVolumes.length;e++){let t=Z.createOscillator();t.type="sine",t.frequency.value=this.fundamentalFrequency*e,t.start();let s=Z.createGain();s.gain.value=this.toneVolumes[e],s.connect(Z.destination),t.connect(s),this.overtones.push([t,s])}this.isStopped=!1}}stop(){if(!this.isStopped){for(let e=this.overtones.length-1;e>=0;e--){let[t,s]=this.overtones[e];t.stop(),t.disconnect(s),s.disconnect(Z.destination),this.overtones.pop()}this.isStopped=!0}}voiceCharacter(e){let t=e.toLowerCase();if(/[a-z0-9]/.test(t)){this.start();let e=1-(t.charCodeAt(0)%10+1)/100;/[aeiou]/.test(t)?(this.changeVolume(1),this.changeFrequency(this.fundamentalFrequency*e*({a:1.3,e:1.2,i:1.4,o:1.1,u:1.3})[t])):(this.changeVolume(.9),this.changeFrequency(this.fundamentalFrequency*e))}else" "!=t&&this.stop()}constructor(e,t){this.overtones=[],this.toneVolumes=[],this.fundamentalFrequency=180,this.isStopped=!1,this.overtones=[],this.fundamentalFrequency=e,this.toneVolumes=t,this.isStopped=!0}}class H{getProps(){return this.propsStack[this.propsStack.length-1]}async queueTextAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.isBusy?this.queue.push({text:e,caller:t}):await this.startParsingAsync(e,t)}async startParsingAsync(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e=this.replaceMacros(this.extractMacros(e)),1==this.propsStack.length&&(this.isBusy=!0,!this.lastCharacter||/^\s/.test(e)||/\s$/.test(this.lastCharacter)||(e=" "+e),e=this.story.model.markNodesInText(e));let s="",n=0;for(let a=0;a<e.length;a++){if("$"==e[a]&&"{"==e[a+1]){e=e.slice(0,a)+this.evaluateScript(e.slice(a),t),a--;continue}let i=e[a];if("["==i&&(0==n&&s&&(await this.typeAsync(s),s=""),n++),s+=i,"]"==i){if(--n<0)throw Error("Mismatched brackets < 0");0==n&&(await this.handleCommandAsync(s),s="")}}if(0!=n)throw Error("Mismatched brackets > 0");if(await this.typeAsync(s),1==this.propsStack.length){if(this.queue.length>0){let e=this.queue.shift();await this.startParsingAsync(e.text,e.caller);return}this.isBusy=!1}}evaluateScript(e,t){let s=1,n="";for(let t=2;t<e.length;t++){let a=e[t];if("}"==a){if(--s<0)throw Error("Mismatched brackets < 0");if(0==s){e=e.slice(t+1);break}}n+=a}let a=(null!=t?t:this.story.model).evaluateVariableExpression(n);return null!=this.story&&(a=this.story.model.markNodesInText(a)),a+e}extractMacros(e){let t=/\$(\w+)\s*=\s*(.+)$/gm;for(let s of e.matchAll(t))this.macros.set(s[1],s[2]);return e=e.replaceAll(t,"[DELETE]").replaceAll(/\[DELETE\](?:\r\n|\r|\n)/g,"")}async typeAsync(e){let t=this.getProps(),s=this.renderedTextBlocks.push([t,[]])-1,n=t.volumes.length>0?new J(t.pitch,t.volumes):null;for(let a of e){this.renderedTextBlocks[s][1].push(a),this.lastCharacter=a;let e=[".","!","?"].includes(a),i=[",",";",":"].includes(a),r=t.typeSpeed;e&&(r=25*t.typeSpeed),i&&(r=10*t.typeSpeed),null==n||n.voiceCharacter(a),await f(r)}null==n||n.stop()}replaceMacros(e){for(let[t,s]of this.macros)e=e.replaceAll("${".concat(t,"}"),s);return e}async handleCommandAsync(e){let t=e.slice(1,-1),s=[],n="",a=0;for(let e of t)"["==e?a++:"]"==e&&a--,";"==e&&0==a?(s.push(n),n=""):n+=e;(n||t.endsWith(";"))&&s.push(n),this.startNesting();try{let e=X(s[0],s.slice(1));e instanceof Promise&&await e}finally{this.endNesting()}}startNesting(){let e=JSON.parse(JSON.stringify(this.getProps()));this.propsStack.push(e)}endNesting(){if(this.propsStack.pop(),0==this.propsStack.length)throw Error("Ended nesting more often than starting it.")}constructor(e,t){this.renderedTextBlocks=[],this.isBusy=!1,this.propsStack=[],this.macros=new Map,this.lastCharacter="",this.queue=[],this.story=t,(0,w.l_)(this),this.propsStack.push(e)}}let K={},Q=new Proxy(K,{get:(e,t)=>K[t].getFlattenedObject(),set:(e,t,s)=>(K[t]=s,!0)});class ee{get id(){return this._id}get name(){return this._name}set name(e){this._name!==e&&(delete Q[this._id],this._name=e,this._id=this.generateId(),Q[this._id]=this)}traverseNodeTree(){let e=[this];for(let t of this.children)for(let s of t.traverseNodeTree())e.push(s);return e}addChild(e){var t;e.parent!==this&&e!==this&&(null==(t=e.parent)||t.removeChild(e),this.children.push(e),e.parent=this)}removeChild(e){e.parent===this&&(this.children=this.children.filter(t=>t!==e),e.parent=null)}addCheckAction(){this.actions.push(new g(["Inspect","Assess","Analyze","Probe","Scan","Investigate","Survey","Examine","Check","Explore","Look"],'${[this.description, ...this.children.map((c) => c.context)].join(" ")}',this))}getFlattenedObject(){let e={};for(let t in this)Object.defineProperty(e,t,{get:()=>this[t],set:e=>{this[t]=e},enumerable:!0,configurable:!0});for(let t of["id","name"])Object.defineProperty(e,t,{get:()=>this[t],set:e=>{this[t]=e},enumerable:!0,configurable:!0});for(let t of this.properties||[])Object.defineProperty(e,t.name,{get:()=>t.value,set:e=>{t.value=e},enumerable:!0,configurable:!0});return e}evaluateVariableExpression(e){let t={global:Q};try{let s=Function(...Object.keys(t),"return ".concat(e,";")).apply(this.getFlattenedObject(),Object.values(t));if(void 0!==s)return s.toString();return""}catch(e){return console.error("Expression evaluation error:",e),""}}async writeAsync(e){await n.queueTextAsync(e,this)}generateId(){let e=this.name.replace(/[^a-zA-Z0-9]/g,"_").toLowerCase(),t=0,s=e;for(;s in Q;)s="".concat(e,"_").concat(++t);return s}isInside(e){return this.coordinates.x>=e.coordinates.x&&this.coordinates.y>=e.coordinates.y&&this.coordinates.z>=e.coordinates.z&&this.coordinates.x+this.dimensions.width<=e.coordinates.x+e.dimensions.width&&this.coordinates.y+this.dimensions.depth<=e.coordinates.y+e.dimensions.depth&&this.coordinates.z+this.dimensions.height<=e.coordinates.z+e.dimensions.height}constructor(e,t,s){this.color="#AAFFFF",this.image="",this.properties=[],this.events=[],this.children=[],this.parent=null,this.actions=[],this.sounds=[],this.coordinates=new p(0,0,0),this.dimensions=new x(1,1,1),this.name=e,this.context=t,this.description=s,this.addCheckAction()}}ee=(0,d.Cg)([u],ee);class et extends ee{modifyCoordinates(e){e(this.coordinates),b.emit("player_moved",this.coordinates)}async performActionAsync(e){let t=[...this.parent.actions];for(let e of this.parent.children)t.push(...e.actions);let s=function(e,t){let s=t.toLowerCase().replaceAll(/[^a-z0-9 ]/g,"").split(" ");for(let t of e)if(t.matches(s))return t;return null}(t,e);await (null==s?void 0:s.triggerAsync())}constructor(e,t){super(e,"",""),this.coordinates=t}}et=(0,d.Cg)([u],et);class es extends ee{markNodesInText(e){for(let t of[this,this.player.parent,...this.player.parent.children])e=e.replace(RegExp("(^|\\s)(".concat(t.name.toLowerCase(),")"),"gmi"),"$1[color;".concat(t.color,";$2]"));return e}insertHierarchically(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];for(let e of(t.sort((e,t)=>{let s=e.dimensions.getArea();return t.dimensions.getArea()-s}),t)){let t=this;for(let s=0;s<t.children.length;s++){let n=t.children[s];e.isInside(n)&&(t=n,s=-1)}for(let s of t.children)s.isInside(e)&&e.addChild(s);t.addChild(e)}}constructor(e,t,s,n){super(e,t,s),this.color="#FFFFAA",this.player=n}}es=(0,d.Cg)([u],es);class en extends ee{addMoveToAction(){this.actions.push(new g(["Walk","Jog","Run","Sprint","Dash","March","Stroll","Saunter","Amble","Trek","Hike","Wander","Strut","Mosey","Glide","Shuffle","Tiptoe","Creep","Scurry","Scuttle","Rush","Charge","Bolt","Gallop","Bound","Lumber","Trudge","Stride","Pace","Roam","Drift","Meander","Advance","Proceed","Migrate","Relocate","Travel","Sneak"],this.moveDescription,this))}constructor(e,t,s,n){super(e,t,s),this.color="#AAAAFF",this.moveDescription=n,this.addMoveToAction()}}en=(0,d.Cg)([u],en);let ea=new et("Player",new m(0,0,0));new en("Door","Test","Test","Test");let ei=new es("Demo","","",ea);ei.dimensions.width=100,ei.dimensions.height=100,ei.dimensions.depth=100,ei.actions.push(new g(["start","begin"],"This is a [color;orange;demo] story.",ei)),ei.insertHierarchically(ea);var er=s(9434);function eo(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,er.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function el(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,er.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-[data-slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function ec(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,er.cn)("leading-none font-semibold",t),...s})}function ed(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,er.cn)("px-6",t),...s})}var eh=s(2523),eu=s(285),ep=s(2346),em=s(736);function eg(e){let{...t}=e;return(0,a.jsx)(em.bL,{"data-slot":"context-menu",...t})}function ex(e){let{...t}=e;return(0,a.jsx)(em.l9,{"data-slot":"context-menu-trigger",...t})}function ef(e){let{className:t,...s}=e;return(0,a.jsx)(em.ZL,{children:(0,a.jsx)(em.UC,{"data-slot":"context-menu-content",className:(0,er.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...s})})}function ev(e){let{className:t,inset:s,variant:n="default",...i}=e;return(0,a.jsx)(em.q7,{"data-slot":"context-menu-item","data-inset":s,"data-variant":n,className:(0,er.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i})}var ey=s(968);function eb(e){let{className:t,...s}=e;return(0,a.jsx)(ey.b,{"data-slot":"label",className:(0,er.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}let ew=(0,l.PA)(e=>{let{viewModel:t,onSelectionChanged:s}=e;return(0,a.jsxs)(eg,{children:[(0,a.jsx)(ex,{children:(0,a.jsxs)("div",{onClick:function(e){e.stopPropagation(),s(t)},className:"w-full h-full backdrop-blur-[16px] bg-[#333333b0]",style:{borderColor:t.isSelected?"#888822f0":"#000000",borderWidth:t.dimensions.width*ej/50},children:[(0,a.jsx)("div",{className:"text-center p-2",style:{color:t.color,fontSize:t.dimensions.width*ej/10},children:t.name}),t.children.map((e,t)=>(0,a.jsx)("div",{className:"absolute",style:{left:e.coordinates.x*ej,top:e.coordinates.y*ej,width:e.dimensions.width*ej,height:e.dimensions.depth*ej,transition:"0.1s"},children:(0,a.jsx)(ew,{viewModel:e,onSelectionChanged:s},t)},t))]})}),(0,a.jsxs)(ef,{children:[(0,a.jsxs)(ev,{onClick:e=>e.stopPropagation(),onSelect:function(){t.addChildObject(),s(t.children[t.children.length-1])},children:["Add child object to ",t.name]}),(0,a.jsxs)(ev,{children:["Add child location to ",t.name]})]})]})}),ej=100,eN=(0,l.PA)(e=>{let{rootNode:t,onSelectionChanged:s}=e,[n,o]=(0,i.useState)({x:0,y:0}),[l,c]=(0,i.useState)({x:0,y:0}),[d,h]=(0,i.useState)(1);return(0,a.jsxs)("div",{className:"w-full h-full overflow-hidden bg-[#ffffff10] relative rounded-lg",onWheel:e=>{h(t=>t+t/10*(e.deltaY>0?-1:1))},onMouseMove:e=>{4===e.buttons&&c(t=>({x:t.x+e.movementX,y:t.y+e.movementY})),e.currentTarget.getBoundingClientRect(),o({x:(e.clientX-e.currentTarget.getBoundingClientRect().left-l.x)/d/ej,y:(e.clientY-e.currentTarget.getBoundingClientRect().top-l.y)/d/ej})},children:[(0,a.jsxs)(eg,{children:[(0,a.jsx)(ex,{children:(0,a.jsx)("div",{className:"w-full h-full relative",style:{transform:"translate(".concat(l.x,"px, ").concat(l.y,"px)")},children:(0,a.jsx)("div",{className:"w-full h-full relative",style:{transform:"scale(".concat(d,")"),transformOrigin:"top left",transition:"0.1s"},children:(0,a.jsx)("div",{className:"absolute",style:{left:t.coordinates.x*ej,top:t.coordinates.y*ej,width:t.dimensions.width*ej,height:t.dimensions.depth*ej},children:(0,a.jsx)(ew,{viewModel:t,onSelectionChanged:s})})})})}),(0,a.jsxs)(ef,{children:[(0,a.jsx)(ev,{children:"Add object"}),(0,a.jsx)(ev,{children:"Add location"})]})]}),(0,a.jsx)("div",{className:"absolute top-0 left-0 p-2",children:(0,a.jsxs)(eu.$,{onClick:()=>{h(1),c({x:0,y:0})},children:[(0,a.jsx)(r.SE2,{}),"Reset"]})}),(0,a.jsxs)("div",{className:"absolute bottom-0 left-0 p-2 bg-[#00000080] rounded-tr-lg",children:[(0,a.jsxs)(eb,{children:["Position: ",n.x.toFixed(2),"x ",n.y.toFixed(2),"y"]}),(0,a.jsxs)(eb,{children:["Scale: ",d.toFixed(2),"x"]})]}),(0,a.jsx)("div",{className:"absolute bottom-0 p-2 right-1/2 border-t-2 flex justify-center",style:{width:ej},children:(0,a.jsxs)(eb,{children:[(1/d).toFixed(2),"m"]})})]})});var eC=s(704);function e_(e){let{className:t,...s}=e;return(0,a.jsx)(eC.bL,{"data-slot":"tabs",className:(0,er.cn)("flex flex-col gap-2",t),...s})}function eA(e){let{className:t,...s}=e;return(0,a.jsx)(eC.B8,{"data-slot":"tabs-list",className:(0,er.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...s})}function ek(e){let{className:t,...s}=e;return(0,a.jsx)(eC.l9,{"data-slot":"tabs-trigger",className:(0,er.cn)("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/50 inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function eS(e){let{className:t,...s}=e;return(0,a.jsx)(eC.UC,{"data-slot":"tabs-content",className:(0,er.cn)("flex-1 outline-none",t),...s})}function ez(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,er.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}var eT=s(4592);function eP(e){let{className:t,...s}=e;return(0,a.jsx)(eT.bL,{"data-slot":"menubar",className:(0,er.cn)("bg-background flex h-9 items-center gap-1 rounded-md border p-1 shadow-xs",t),...s})}function eF(e){let{...t}=e;return(0,a.jsx)(eT.W1,{"data-slot":"menubar-menu",...t})}function eE(e){let{...t}=e;return(0,a.jsx)(eT.ZL,{"data-slot":"menubar-portal",...t})}function eI(e){let{className:t,...s}=e;return(0,a.jsx)(eT.l9,{"data-slot":"menubar-trigger",className:(0,er.cn)("focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none",t),...s})}function eD(e){let{className:t,align:s="start",alignOffset:n=-4,sideOffset:i=8,...r}=e;return(0,a.jsx)(eE,{children:(0,a.jsx)(eT.UC,{"data-slot":"menubar-content",align:s,alignOffset:n,sideOffset:i,className:(0,er.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[12rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-md",t),...r})})}function eL(e){let{className:t,inset:s,variant:n="default",...i}=e;return(0,a.jsx)(eT.q7,{"data-slot":"menubar-item","data-inset":s,"data-variant":n,className:(0,er.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i})}var eM=s(4033),eO=s(4416);function e$(e){let{...t}=e;return(0,a.jsx)(eM.bL,{"data-slot":"dialog",...t})}function eR(e){let{...t}=e;return(0,a.jsx)(eM.ZL,{"data-slot":"dialog-portal",...t})}function eq(e){let{className:t,...s}=e;return(0,a.jsx)(eM.hJ,{"data-slot":"dialog-overlay",className:(0,er.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function eB(e){let{className:t,children:s,...n}=e;return(0,a.jsxs)(eR,{"data-slot":"dialog-portal",children:[(0,a.jsx)(eq,{}),(0,a.jsxs)(eM.UC,{"data-slot":"dialog-content",className:(0,er.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...n,children:[s,(0,a.jsxs)(eM.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(eO.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function eV(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,er.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function eW(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,er.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function eG(e){let{className:t,...s}=e;return(0,a.jsx)(eM.hE,{"data-slot":"dialog-title",className:(0,er.cn)("text-lg leading-none font-semibold",t),...s})}function eU(e){let{className:t,...s}=e;return(0,a.jsx)(eM.VY,{"data-slot":"dialog-description",className:(0,er.cn)("text-muted-foreground text-sm",t),...s})}let eY=(0,l.PA)(e=>{let{command:t,onInsert:s}=e;return(0,a.jsxs)(eB,{children:[(0,a.jsxs)(eV,{children:[(0,a.jsx)(eG,{children:t.name}),(0,a.jsx)(eU,{children:t.description})]}),(0,a.jsx)("div",{className:"space-y-4",children:t.parameters.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(eb,{children:e.name}),(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:e.description}),(0,a.jsx)(eh.p,{value:e.value,onChange:t=>e.value=t.target.value})]},t))}),(0,a.jsx)(eW,{children:(0,a.jsx)(eu.$,{onClick:()=>{s(t)},variant:"outline",children:"Insert"})})]})}),eX=(0,l.PA)(e=>{let{text:t,placeholder:s,label:n,isMultiline:r=!0,onChange:o}=e,[l,c]=(0,i.useState)(!1),[d,h]=(0,i.useState)(!1),[u,p]=(0,i.useState)(C[0]),[m,g]=(0,i.useState)([0,0]);return(0,a.jsxs)("div",{onBlur:()=>c(!1),onFocus:()=>c(!0),children:[(0,a.jsx)(e$,{open:d,onOpenChange:h,children:(0,a.jsx)(eY,{command:u,onInsert:e=>(function(e){var s;let n=t.substring(0,m[0]),a=t.substring(m[1]);s=n+e.toString()+a,o&&o(s),h(!1)})(e)})}),null!=n&&n.length>0?(0,a.jsx)(eb,{className:"mb-2",children:n}):null,r?(0,a.jsx)(ez,{onSelectCapture:e=>g([e.currentTarget.selectionStart,e.currentTarget.selectionEnd]),id:"textfield",placeholder:s,value:t,onChange:e=>{var t;return t=e.target.value,void(o&&o(t))}}):(0,a.jsx)(eh.p,{onSelectCapture:e=>g([e.currentTarget.selectionStart,e.currentTarget.selectionEnd]),placeholder:s,value:t,onChange:e=>{var t;return t=e.target.value,void(o&&o(t))}}),l?(0,a.jsx)(eP,{className:"bg-[#00000000]",children:(0,a.jsxs)(eF,{children:[(0,a.jsx)(eI,{children:"Add command"}),(0,a.jsx)(eD,{children:C.map((e,s)=>(0,a.jsx)(eL,{className:"cursor-pointer",onClick:()=>{let s=e.clone();s.parameters[s.parameters.length-1].value=t.substring(m[0],m[1]),p(s),h(!0)},children:e.name},e.name))})]})}):null]})});var eZ=s(8767),eJ=s(6474),eH=s(5196),eK=s(7863);function eQ(e){let{...t}=e;return(0,a.jsx)(eZ.bL,{"data-slot":"select",...t})}function e0(e){let{...t}=e;return(0,a.jsx)(eZ.YJ,{"data-slot":"select-group",...t})}function e1(e){let{...t}=e;return(0,a.jsx)(eZ.WT,{"data-slot":"select-value",...t})}function e2(e){let{className:t,size:s="default",children:n,...i}=e;return(0,a.jsxs)(eZ.l9,{"data-slot":"select-trigger","data-size":s,className:(0,er.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[n,(0,a.jsx)(eZ.In,{asChild:!0,children:(0,a.jsx)(eJ.A,{className:"size-4 opacity-50"})})]})}function e5(e){let{className:t,children:s,position:n="popper",...i}=e;return(0,a.jsx)(eZ.ZL,{children:(0,a.jsxs)(eZ.UC,{"data-slot":"select-content",className:(0,er.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...i,children:[(0,a.jsx)(e3,{}),(0,a.jsx)(eZ.LM,{className:(0,er.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(e9,{})]})})}function e4(e){let{className:t,children:s,...n}=e;return(0,a.jsxs)(eZ.q7,{"data-slot":"select-item",className:(0,er.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(eZ.VF,{children:(0,a.jsx)(eH.A,{className:"size-4"})})}),(0,a.jsx)(eZ.p4,{children:s})]})}function e3(e){let{className:t,...s}=e;return(0,a.jsx)(eZ.PP,{"data-slot":"select-scroll-up-button",className:(0,er.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(eK.A,{className:"size-4"})})}function e9(e){let{className:t,...s}=e;return(0,a.jsx)(eZ.wn,{"data-slot":"select-scroll-down-button",className:(0,er.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(eJ.A,{className:"size-4"})})}var e8=function(e){return e.Text="text",e.Number="number",e.Boolean="boolean",e}({});class e6{get name(){return this._name}set name(e){this._name=e,this.model.name=e}get value(){return this._value}set value(e){this._value=e,this.model.value=e}constructor(e){this.model=e,this._name=e.name,this._value=e.value,"boolean"==typeof e.value?this.textType="boolean":"number"==typeof e.value?this.textType="number":this.textType="text",(0,w.l_)(this)}}let e7=(0,l.PA)(e=>{let{property:t,onDelete:s}=e,n=null,i=(0,a.jsxs)(eQ,{value:t.textType,onValueChange:e=>t.textType=e,children:[(0,a.jsx)(e2,{children:(0,a.jsx)(e1,{placeholder:"Select an option"})}),(0,a.jsx)(e5,{children:(0,a.jsx)(e0,{children:Object.keys(e8).map(e=>{let t=e8[e];return(0,a.jsx)(e4,{value:t,children:e},t)})})})]});return t.textType==e8.Text?n=(0,a.jsx)(eX,{isMultiline:!1,text:t.value,onChange:e=>t.value=e}):t.textType==e8.Number?n=(0,a.jsx)(eh.p,{type:"number",value:t.value,onChange:e=>t.value=e.currentTarget.valueAsNumber}):t.textType==e8.Boolean&&(n=(0,a.jsxs)(eQ,{value:t.value,onValueChange:e=>t.value="true"===e,children:[(0,a.jsx)(e2,{children:(0,a.jsx)(e1,{placeholder:"Select an option"})}),(0,a.jsx)(e5,{children:(0,a.jsxs)(e0,{children:[(0,a.jsx)(e4,{value:"true",children:"True"}),(0,a.jsx)(e4,{value:"false",children:"False"})]})})]})),(0,a.jsxs)("div",{className:"space-y-4 hover:bg-muted transition-colors rounded p-2",children:[(0,a.jsxs)("div",{id:"header",className:"grid grid-cols-[1fr_auto] gap-4",children:[(0,a.jsx)(eh.p,{value:t.name,onChange:e=>t.name=e.target.value}),(0,a.jsx)(eu.$,{variant:"ghost",onClick:()=>s(t),children:(0,a.jsx)(r.IXo,{color:"salmon"})})]}),i,n]})}),te=(0,l.PA)(e=>{let{storyEvent:t,onDelete:s}=e;return(0,a.jsxs)("div",{className:"space-y-4 hover:bg-muted transition-colors rounded p-2",children:[(0,a.jsxs)("div",{id:"header",className:"grid grid-cols-[1fr_auto] gap-4",children:[(0,a.jsx)(eh.p,{value:t.eventName,onChange:e=>t.eventName=e.target.value}),(0,a.jsx)(eu.$,{variant:"ghost",onClick:()=>s(t),children:(0,a.jsx)(r.IXo,{color:"salmon"})})]}),(0,a.jsx)(eX,{text:t.response,onChange:e=>t.response=e,placeholder:"Description"})]})}),tt=(0,l.PA)(e=>{let{action:t,onDelete:s}=e;return(0,a.jsxs)("div",{className:"space-y-4 hover:bg-muted transition-colors rounded p-2",children:[(0,a.jsxs)("div",{id:"header",className:"grid grid-cols-[1fr_auto] gap-4",children:[(0,a.jsx)(eh.p,{placeholder:"Names",value:t.actionNames,onChange:e=>t.actionNames=e.target.value}),(0,a.jsx)(eu.$,{variant:"ghost",onClick:()=>s(t),children:(0,a.jsx)(r.IXo,{color:"salmon"})})]}),(0,a.jsx)(eX,{text:t.response,onChange:e=>t.response=e,placeholder:"Description"})]})}),ts=(0,l.PA)(e=>{let{viewModel:t}=e;return(0,a.jsxs)(e_,{defaultValue:"properties",className:"h-full",children:[(0,a.jsxs)(eA,{className:"w-full",children:[(0,a.jsx)(ek,{value:"properties",children:"Properties"}),(0,a.jsx)(ek,{value:"actions",children:"Actions"}),(0,a.jsx)(ek,{value:"events",children:"Events"})]}),(0,a.jsxs)(eS,{value:"properties",className:"overflow-auto space-y-4",children:[(0,a.jsx)(eo,{children:(0,a.jsxs)(ed,{className:"space-y-4",children:[(0,a.jsx)(eb,{children:"Id"}),(0,a.jsxs)("div",{id:"header",className:"grid grid-cols-[1fr_auto] gap-4",children:[(0,a.jsx)(eh.p,{disabled:!0,value:t.id}),(0,a.jsx)(eu.$,{variant:"ghost",onClick:()=>{var e;return null==(e=t.parent)?void 0:e.removeChildObject(t)},children:(0,a.jsx)(r.IXo,{color:"salmon"})})]}),(0,a.jsx)(eb,{children:"Name"}),(0,a.jsx)(eh.p,{value:t.name,onChange:e=>t.name=e.target.value}),(0,a.jsx)(eX,{label:"Description",text:t.description,onChange:e=>t.description=e,placeholder:"You can see an old wooden table, brittle from being exposed to water."}),(0,a.jsx)(eX,{label:"Context",text:t.context,onChange:e=>t.context=e,placeholder:"A wooden table can be seen in the corner of the room."}),(0,a.jsx)(eb,{children:"Dimensions (m)"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(eh.p,{type:"number",min:0,placeholder:"Width",value:t.dimensions.width,onChange:e=>t.dimensions.width=e.target.valueAsNumber}),(0,a.jsx)(eh.p,{type:"number",min:0,placeholder:"Depth",value:t.dimensions.depth,onChange:e=>t.dimensions.depth=e.target.valueAsNumber}),(0,a.jsx)(eh.p,{type:"number",min:0,placeholder:"Height",value:t.dimensions.height,onChange:e=>t.dimensions.height=e.target.valueAsNumber})]}),(0,a.jsx)(eb,{children:"Location"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(eh.p,{type:"number",placeholder:"X",value:t.coordinates.x,onChange:e=>t.coordinates.x=e.target.valueAsNumber}),(0,a.jsx)(eh.p,{type:"number",placeholder:"Y",value:t.coordinates.y,onChange:e=>t.coordinates.y=e.target.valueAsNumber}),(0,a.jsx)(eh.p,{type:"number",placeholder:"Z",value:t.coordinates.z,onChange:e=>t.coordinates.z=e.target.valueAsNumber})]})]})}),(0,a.jsx)(eo,{children:(0,a.jsxs)(ed,{className:"space-y-4",children:[t.properties.map((e,s)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(e7,{property:e,onDelete:e=>t.removeProperty(e)},s),(0,a.jsx)(ep.w,{className:"my-4"})]},s)),(0,a.jsxs)(eu.$,{variant:"outline",onClick:()=>t.addProperty(),children:[(0,a.jsx)(r.GGD,{})," Add property"]})]})})]}),(0,a.jsx)(eS,{value:"actions",className:"overflow-auto",children:(0,a.jsx)(eo,{children:(0,a.jsxs)(ed,{className:"space-y-4",children:[t.actions.map((e,s)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(tt,{action:e,onDelete:e=>t.removeAction(e)},s),(0,a.jsx)(ep.w,{className:"my-4"})]},s)),(0,a.jsxs)(eu.$,{variant:"outline",onClick:()=>t.addAction(),children:[(0,a.jsx)(r.GGD,{})," Add interaction"]})]})})}),(0,a.jsx)(eS,{value:"events",className:"overflow-auto",children:(0,a.jsx)(eo,{children:(0,a.jsxs)(ed,{className:"space-y-4",children:[t.events.map((e,s)=>(0,a.jsxs)("div",{children:[(0,a.jsx)(te,{storyEvent:e,onDelete:e=>t.removeStoryEvent(e)},s),(0,a.jsx)(ep.w,{className:"my-4"})]},s)),(0,a.jsxs)(eu.$,{variant:"outline",onClick:()=>t.addStoryEvent(),children:[(0,a.jsx)(r.GGD,{})," Add event handler"]})]})})})]})});var tn=s(8021),ta=s(9730);function ti(e){let{className:t,...s}=e;return(0,a.jsx)(ta.YZ,{"data-slot":"resizable-panel-group",className:(0,er.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...s})}function tr(e){let{...t}=e;return(0,a.jsx)(ta.Zk,{"data-slot":"resizable-panel",...t})}function to(e){let{withHandle:t,className:s,...n}=e;return(0,a.jsx)(ta.TW,{"data-slot":"resizable-handle",className:(0,er.cn)("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",s),...n,children:t&&(0,a.jsx)("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:(0,a.jsx)(tn.A,{className:"size-2.5"})})})}let tl=(0,l.PA)(e=>{let{storyNode:t}=e,[s,n]=(0,i.useState)(t);return(0,a.jsxs)(ti,{direction:"horizontal",className:"rounded-lg border",children:[(0,a.jsx)(tr,{defaultSize:100,children:(0,a.jsx)("div",{className:"p-4 h-full",children:(0,a.jsx)(eN,{rootNode:t,onSelectionChanged:function(e){null!=s&&(s.isSelected=!1),null!=e&&(e.isSelected=!0),n(e)}})})}),(0,a.jsx)(to,{}),(0,a.jsx)(tr,{defaultSize:30,children:(0,a.jsx)("div",{className:"p-4 h-full",children:(0,a.jsx)(ts,{viewModel:s})})})]})});class tc{get x(){return this._x}set x(e){this._x=e,this.model.x=e}get y(){return this._y}set y(e){this._y=e,this.model.y=e}get z(){return this._z}set z(e){this._z=e,this.model.z=e}constructor(e){this.model=e,this._x=e.x,this._y=e.y,this._z=e.z,(0,w.l_)(this)}}class td{get width(){return this._width}set width(e){this._width=e,this.model.width=e}get depth(){return this._depth}set depth(e){this._depth=e,this.model.depth=e}get height(){return this._height}set height(e){this._height=e,this.model.height=e}constructor(e){this.model=e,this._width=e.width,this._depth=e.depth,this._height=e.height,(0,w.l_)(this)}}class th{get eventName(){return this._eventName}set eventName(e){this._eventName=e,this.model.eventName=e,this.model.register()}get response(){return this._response}set response(e){this._response=e,this.model.response=e}constructor(e){this.model=e,this._eventName=e.eventName,this._response=e.response,(0,w.l_)(this)}}class tu{get value(){return this._value}set value(e){this._value=e,b.emitAsync("property_changed:".concat(this.name))}constructor(e,t){this.name=e,this._value=t}}tu=(0,d.Cg)([u],tu);class tp{register(){this.unregister(),b.on(this.eventName,this.callable),this.isRegistered=!0}unregister(){this.isRegistered&&(b.off(this.eventName,this.callable),this.isRegistered=!1)}async handleEvent(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];let n=this.response.replace(/\$(\d+)/g,(e,s)=>t[parseInt(s)]||"");await this.parent.writeAsync(n)}constructor(e,t,s){this.eventName=e,this.response=t,this.parent=s,this.isRegistered=!1,this.callable=this.handleEvent.bind(this),this.register()}}tp=(0,d.Cg)([u],tp);class tm{get actionNames(){return this._actionNames.join(", ")}set actionNames(e){this._actionNames=e.split(", ").map(e=>e.trim().toLowerCase()),this.model.actionNames=this._actionNames}get response(){return this._response}set response(e){this._response=e,this.model.response=e}constructor(e){this.model=e,this._actionNames=e.actionNames,this._response=e.response,(0,w.l_)(this)}}class tg{get name(){return this._name}set name(e){this._name=e,this.model.name=e,this.id=this.model.id}get description(){return this._description}set description(e){this._description=e,this.model.description=e}get context(){return this._context}set context(e){this._context=e,this.model.context=e}addChildObject(){let e=new ee("New Node","New Context","New Description");e.dimensions.width=this.model.dimensions.width/2,e.dimensions.depth=this.model.dimensions.depth/2,e.dimensions.height=this.model.dimensions.height/2,this.model.addChild(e),this.children.push(new tg(e,this))}removeChildObject(e){this.children=this.children.filter(t=>t!==e),this.model.removeChild(e.model)}addProperty(){let e=new tu("New Property",!1);this.properties.push(new e6(e)),this.model.properties.push(e)}removeProperty(e){this.properties=this.properties.filter(t=>t!==e),this.model.properties=this.model.properties.filter(t=>t!==e.model)}addStoryEvent(){let e=new tp("EventName","My response!",this.model);this.events.push(new th(e)),this.model.events.push(e)}removeStoryEvent(e){e.model.unregister(),this.events=this.events.filter(t=>t!==e),this.model.events=this.model.events.filter(t=>t!==e.model)}addAction(){let e=new g(["use"],"You used the ${name}",this.model);this.actions.push(new tm(e)),this.model.actions.push(e)}removeAction(e){this.actions=this.actions.filter(t=>t!==e),this.model.actions=this.model.actions.filter(t=>t!==e.model)}constructor(e,t=null){this.parent=null,this.children=[],this.properties=[],this.events=[],this.actions=[],this.isSelected=!1,this.color="#FFFFFF",this.model=e,this.color=e.color,this._name=e.name,this._description=e.description,this._context=e.context,this.id=e.id,this.parent=t,this.coordinates=new tc(e.coordinates),this.dimensions=new td(e.dimensions),this.children=e.children.map(e=>new tg(e,this)),this.properties=e.properties.map(e=>new e6(e)),this.events=e.events.map(e=>new th(e)),this.actions=e.actions.map(e=>new tm(e)),(0,w.l_)(this)}}var tx=function(e){return e[e.Story=0]="Story",e[e.Editor=1]="Editor",e}(tx||{});function tf(){let[e,t]=(0,i.useState)(""),[s,o]=(0,i.useState)(0),[l,d]=(0,i.useState)(new tg(ei)),[u,p]=(0,i.useState)(new H({opacityAnimationDuration:.3,typeSpeed:50,pitch:0,volumes:[],characterStyle:{fontSize:"20px",color:"#FFFFFF"},characterInitial:{},characterAnimate:{},characterTransition:{}},l)),m=(0,i.useRef)(null),g=(0,i.useRef)(!1);async function x(){t(""),l.model.player.performActionAsync(e),m.current.focus()}return(0,i.useEffect)(()=>{g.current||(g.current=!0,u.startParsingAsync("Enter [color;orange;start] to start the story."),n=u,m.current.focus())},[u]),(0,a.jsxs)("div",{className:"grid grid-rows-[1fr_auto] gap-4 p-8 h-full w-full",children:[(0,a.jsxs)(eo,{className:"bg-[#ffffff10] h-full overflow-auto",children:[(0,a.jsxs)(el,{children:[(0,a.jsx)(ec,{className:"pb-2",children:(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_auto_auto_auto] gap-x-2 items-center",children:[(0,a.jsx)("div",{className:"flex justify-center w-full text-yellow-500",children:l.name}),(0,a.jsx)(eu.$,{variant:"outline",onClick:function(){let e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){let e=new FileReader;e.onload=async e=>{var t;let s=new tg(function(e){let t={};console.log(h);let s=JSON.parse(e,(e,s)=>{if("object"==typeof s&&null!==s){let e=s.__type;if(e&&h[e]){let t=Object.create(h[e].prototype);delete s.__type,Object.assign(t,s),s=t}t[s.__refId]=s,delete s.__refId}return s});return function e(t,s){if("object"==typeof t&&null!==t)for(let n in t)if("string"==typeof t[n]&&t[n].startsWith("$ref:")){let e=t[n].slice(5);t[n]=s[e]}else e(t[n],s)}(s,t),s}(null==(t=e.target)?void 0:t.result)),a=new H({opacityAnimationDuration:.3,typeSpeed:50,pitch:0,volumes:[],characterStyle:{fontSize:"20px",color:"#FFFFFF"},characterInitial:{},characterAnimate:{},characterTransition:{}},s);d(s),p(a),console.log(n=a)},e.readAsText(s)}},e.click()},children:(0,a.jsx)(r.B88,{})}),(0,a.jsx)(eu.$,{variant:"outline",onClick:function(){let e=new Blob([function(e){let t=new Set,s=0;return JSON.stringify(e,(e,n)=>t.has(n)?"$ref:".concat(n.__refId):("object"==typeof n&&null!==n&&(n.__refId=s++,n.__type=n.constructor.name,t.add(n)),n))}(l.model)],{type:"application/json"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="".concat(l.name,".json"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},children:(0,a.jsx)(r.a4x,{})}),(0,a.jsx)(eu.$,{onClick:()=>o((s+1)%2),variant:"outline",children:0===s?(0,a.jsx)(r.SG1,{}):(0,a.jsx)(r.aze,{})})]})}),(0,a.jsx)(ep.w,{})]}),(0,a.jsxs)(ed,{className:"h-0 flex-grow overflow-auto",children:[0===s&&(0,a.jsx)(c,{viewModel:u}),1===s&&(0,a.jsx)(tl,{storyNode:l})]})]}),0===s&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(eh.p,{className:"pr-12",ref:m,type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"What do you do?",onKeyDown:e=>{"Enter"===e.key&&x()}}),(0,a.jsx)(eu.$,{onClick:x,className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-0 bg-transparent text-gray-500 hover:bg-transparent",children:(0,a.jsx)(r.kGk,{})})]})]})}var tv=s(1362);function ty(){let{setTheme:e}=(0,tv.useTheme)();return e("dark"),(0,a.jsx)("div",{className:"w-screen h-100dvh",children:(0,a.jsx)(tf,{})})}},8099:(e,t,s)=>{Promise.resolve().then(s.bind(s,7634))},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>i});var n=s(2596),a=s(9688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,n.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[844,866,633,402,441,684,358],()=>t(8099)),_N_E=e.O()}]);